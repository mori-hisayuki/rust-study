version: 3
env:
  COMPOSE: docker-compose

tasks:
  setup:
    deps: [container-build, up]
    cmds:
      - echo 'setup done'
  container-build:
    internal: true
    cmd: $COMPOSE build
  up:
    internal: true
    cmd: $COMPOSE up -d
  down:
    cmd: $COMPOSE down
  # cargo run
  run:
    cmd: $COMPOSE run --rm cargo cargo run
  # rust環境に入りたいときのみ
  bash:
    cmd: $COMPOSE exec rust-app bash
